(function(){this.FileUploader=function(){function t(n,t,i,r,u,f){var o,e;this.url=n;this.successCallback=t;this.FileInput=i;this.uploadWrapper=r;this.parent=u;this.progressContainer=f!=null?f:"#ProgressContainer";this.fileInput=null;o=this;e=this.parent;this.request=new XMLHttpRequest;this.request.onreadystatechange=function(){var t,n;if(this.readyState===4){e.wait(!1);try{n=JSON.parse(this.response);n=JSON.parse(n)}catch(i){t=i;n={status:"error",data:"Unknown error occurred: ["+this.response+"]"}}n.Status&&(e.addDocumentToList(n.ProviderDocumentGET[0]),e.reset())}};this.fileData=new FormData;this.fileData.append("file",this.FileInput[0].files[0]);this.fileInput=this.FileInput;this.validate()?this.upload():e.wait(!1);return}var n,i;return n=t.prototype,i=self,n.thisObj="",n.fileData,n.request=null,n.url="",n.fileData=null,n.successCallback=null,n.upload=function(){var n;n=$(this.progressContainer).show();this.request.upload.addEventListener("progress",function(t){var i;return i=Math.round(t.loaded/t.total*100),n.find("span.UploadProgress").first().text(i+"%")},!1);this.request.open("POST",this.url);this.request.send(this.fileData)},n.processReadystate=function(n){this.successCallback&&typeof this.successCallback=="function"&&this.successCallback(n)},n.validate=function(){var n;return n=!1,this.parent.Manager.UserId!=null&&this.parent.Manager.ApplicationId!=null&&this.parent.Manager.Key!=null&&this.parent.Manager.ProviderId!=null?(this.fileData.append("applicationId",this.parent.Manager.ApplicationId),this.fileData.append("providerId",this.parent.Manager.ProviderId),this.fileData.append("key",this.parent.Manager.Key),this.fileData.append("userId",this.parent.Manager.UserId),this.fileData.append("docId",$(this.parent.Wrapper).data("docid")),this.fileData.append("docCode",$(this.parent.Wrapper).data("docCode")),this.parent.showMessage(!1,"systemData",systemErrorMessages.ErrorOccured,"error"),n=!0):(this.parent.showMessage(!0,"systemData",systemErrorMessages.ErrorOccured,"error"),n=!1),this.parent.isSimple&&(this.fileData.append("isSimple","true"),this.fileData.append("otherDocType",this.parent.docTypes[0].DocumentTypeIdName)),n&&!this.parent.isSimple&&(this.fileData.append("isSimple","false"),this.parent.DocumentName!=null&&this.parent.DocumentName!==""?(this.fileData.append("docName",this.parent.DocumentName),this.parent.showMessage(!1,"docName",systemErrorMessages.DocumentUploadName,"error")):(this.parent.showMessage(!0,"docName",systemErrorMessages.DocumentUploadName,"error"),n=!1),this.parent.DocumentTypeId!=null&&this.parent.DocumentTypeId>0?(this.fileData.append("docTypeId",this.parent.DocumentTypeId),this.parent.showMessage(!1,"docType",systemErrorMessages.DocumentUploadType,"error")):(this.parent.showMessage(!0,"docType",systemErrorMessages.DocumentUploadType,"error"),n=!1),this.parent.DocumentType!=null&&this.parent.DocumentType!==""?this.fileData.append("docTypeName",this.parent.DocumentType):n=!1),n&&this.FileInput[0].files[0]!=null?(n=!0,this.parent.showMessage(!1,"file",systemErrorMessages.DocumentUploadFile,"error")):(this.parent.showMessage(!0,"file",systemErrorMessages.DocumentUploadFile,"error"),n=!1),n},t}()}).call(this);