(function(){var n={}.hasOwnProperty;this.DocumentUploader=function(){function t(t){var i,s,r,u,e,f,o;this.opts=t!=null?t:{};for(i in t)n.call(t,i)&&(r=t[i],this[i]=r);if(o=this,this.UploadUrl=this.Manager.UploadUrl,this.UploadWrapper=$("<div />").addClass("docUploader"),this.Identifier=$(this.Wrapper).attr("id"),this.isSimple=$(this.Wrapper).data("simple"),this.UploadInput=$("<input/>").attr("type","file"),this.UploadBtn=$("<button />").addClass("buttonGreen small").text("Upload Document"),this.WaitWrapper=$("<div />").text("Please wait.").css("display","none"),this.MessageWrapper=$('<div id="'+this.Identifier+'_messages"><\/div>').css("display",""),this.DocumentLable="Document : ",this.DocumentName="",$(this.Wrapper).data("doclable")!=null&&(this.DocumentLable=$(this.Wrapper).data("doclable")+": "),console.log("doc_"+$(this.Wrapper).data("docid"),"doc_"+$(this.Wrapper).data("doccode")),s=this.Manager.DocumentTypeNames["doc_"+$(this.Wrapper).data("docid")][0],this.docTypes=this.Manager.DocumentTypeNames["doc_"+$(this.Wrapper).data("docid")],this.docNameInput=this.AllDocuments=[],this.listWrapper,this.isSimple||(this.$complexWrapper=$.el("table",{"class":"wthtop20 complex uploader",width:"99%","margin-left":"5px"}).append($.el("tr",{}).append($.el("td",{"class":"txtalgnrgt"}).append($.el("label",{"class":"input-label required"}).text("Document Name : ")),$.el("td",{}).append($.el("input",{type:"text",name:this.Identifier+"_docName",id:this.Identifier+"_docName"}).blur({parent:o},function(n){return console.log(n.data.parent,"Parent Object Blur"),this.value!=null&&this.value!==""?(n.data.parent.DocumentName=$(this).val(),n.data.parent.showMessage(!1,"docName",systemErrorMessages.DocumentUploadName,"error")):(n.data.parent.DocumentName="",n.data.parent.showMessage(!0,"docName",systemErrorMessages.DocumentUploadName,"error"))})),$.el("td",{"class":"txtalgnrgt"}).append($.el("label",{"class":"input-label required"}).text("Document Type : ")),$.el("td",{}).append($.el("select",{name:this.Identifier+"_docType",id:this.Identifier+"_docType"}).append($.el("option",{selected:"selected",value:0}).text("Select Type")).change({parent:this},function(n){return this.value>0?(n.data.parent.DocumentTypeId=this.value,n.data.parent.DocumentType=$(this).find("option:selected").text(),n.data.parent.showMessage(!1,"docType",systemErrorMessages.DocumentUploadType,"error")):(n.data.parent.DocumentTypeId=0,n.data.parent.DocumentType="",n.data.parent.showMessage(!0,"docType",systemErrorMessages.DocumentUploadType,"error"))}))),$.el("tr",{}).append($.el("td",{"class":"txtalgnrgt"}).append($.el("label",{"class":"input-label required"}).text("Document : ")),$.el("td",{}).append(this.UploadInput),$.el("td",{"class":""}).append(this.UploadBtn),$.el("td",{})))),this.docTypes!=null)if(this.isSimple)this.DocumentLable=this.docTypes[0].DocumentTypeIdName;else for(f=this.docTypes,i=u=0,e=f.length;u<e;i=++u)r=f[i],this.$complexWrapper.find("#"+this.Identifier+"_docType").first().append($.el("option",{}).val(r.DocumentTypeId).text(r.DocumentTypeIdName));this.init(this)}return t.p=t.prototype,t.p.UploadUrl="Upload",t.p.Manager,t.p.Wrapper,t.p.UploadWrapper,t.p.UploadInput,t.p.UploadBtn,t.p.Identifier,t.p.AllDocuments=[],t.p.listWrapper,t.p.DocumentName="",t.p.DocumentType="",t.p.DocumentTypeId="",t.p.isSimple,t.p.WaitWrapper,t.p.DocumentLable,t.p.init=function(n){var i,u,r,t;this.self=n;t=this.self;r=$(this.Wrapper);i=$(this.UploadWrapper);u=$(this.WaitWrapper);$(this.UploadInput).attr("id",this.Identifier+"_input");$(this.UploadBtn).click({input:this.UploadInput,uplWrapper:this.UploadWrapper,parent:t},function(n){return n.data.parent.wait(!0),new FileUploader(n.data.parent.UploadUrl,n.data.parent.documentUploadSuccess,n.data.input,n.data.uplWrapper,n.data.parent)});$(this.UploadWrapper).attr("id",this.Identifier+"_Uploader");this.isSimple?i.append($.el("label",{"class":"simple-label"}).text(this.DocumentLable+" : "),this.UploadInput,this.UploadBtn):i.append(this.$complexWrapper);i.append(u);r.append(this.UploadWrapper,this.MessageWrapper);this.Manager.loadAllDocument(r.data("docid")).done(function(n){return console.log(n,"loaded All Documents"),n.Status?(t.AllDocuments=n.ProviderDocumentGET,t.createDocumentsList("doc_"+$(t.Wrapper).data("docid"),t.AllDocuments)):void 0})},t.p.documentUploadSuccess=function(){},t.p.createDocumentsList=function(n,t){var u,i,r,f;for(this.listWrapper=$(this.Wrapper).find(this.Identifier+"_docList").first(),$(this.Wrapper).find(this.Identifier+"_docList").length===0&&(this.listWrapper=this.createDocumentTableTemplate(),$(this.Wrapper).append(this.listWrapper)),i=r=0,f=t.length;r<f;i=++r)u=t[i],this.addDocumentToList(u,i)},t.p.createDocumentTableTemplate=function(){return $.el("table",{"class":"index vlign grid gridtable",width:"100%"}).append($.el("tr",{}).append($.el("th",{"class":"txtalgnrgt"}).text("Document Type"),$.el("th",{style:"text-align : center"}).text("Document Name"),$.el("th",{}).text("Document Link"),$.el("th",{}).text("Action")))},t.p.addDocumentToList=function(n,t){var r,i,u,f;console.log(n,this);u=this;r=$.el("img",{src:"../../Content/Theme1/images/delete.png"}).css("cursor","pointer");f=n.DocumentTypeIdName;u.isSimple&&(f=n.OtherDocumentTypeName);i=$.el("tr",{}).append($.el("td",{}).text(f),$.el("td",{}).text(n.DocumentName),$.el("td",{}).append($.el("a",{href:n.DocumentPath,"class":"documentdetail"}).text("Document Detail")),$.el("td",{}).append(r));r.click({document:n,ind:t,_self:u,docEle:i},function(n){if(confirm("Really want delete this document?"))return n.data._self.removeDocument(n.data.document,n.data.ind,n.data.docEle,n.data._self)});this.listWrapper!=null?($(this.listWrapper).append(i),this.refreshDocumentList()):(this.listWrapper=this.createDocumentTableTemplate(),$(this.listWrapper).append(i),$(this.Wrapper).append(this.listWrapper))},t.p.removeDocument=function(n,t,i,r){return $(i).remove(),r.Manager.removeDocument(n).done(function(){return $(n).remove(),$(i).remove(),r.refreshDocumentList()})},t.p.refreshDocumentList=function(){return $(this.listWrapper).find("tr").length===1?$(this.listWrapper).css("display","none"):$(this.listWrapper).css("display","")},t.p.wait=function(n){return n?$(this.WaitWrapper).css("display",""):$(this.WaitWrapper).css("display","none")},t.p.showMessage=function(n,t,i,r){var u;return u=$(this.MessageWrapper).find("."+t),console.log(u,"Error Object",i,"Message"),n&&(u.length===0?$(this.MessageWrapper).append($.el("div",{"class":t+" "+r}).text(i)):u.css("display","")),!n&&u!=null?u.css("display","none"):void 0},t.p.reset=function(){return this.UploadInput.replaceWith($(this.UploadInput).clone()),this.isSimple?void 0:($("#"+this.Identifier+"_docName").val(""),$("#"+this.Identifier+"_docType").val(0),this.DocumentTypeId=0,this.DocumentType="",this.DocumentName="")},t}()}).call(this);