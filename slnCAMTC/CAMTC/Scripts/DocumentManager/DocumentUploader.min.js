(function(){var n={}.hasOwnProperty;this.DocumentUploader=function(){function t(t){var i,r,u;this.opts=t!=null?t:{};for(i in t)n.call(t,i)&&(r=t[i],this[i]=r);console.log(this.Manager,"Manager");u=this;this.UploadWrapper=$("<div />").addClass("docUploader");this.Identifier=$(this.Wrapper).attr("id");this.isSimple=$(this.Wrapper).data("simple");this.UploadInput=$("<input/>").attr("type","file");this.UploadBtn=$("<button />").addClass("buttonGreen small").text("Upload Document");this.WaitWrapper=$("<div />").text("Please wait.").css("display","none");this.AllDocuments=[];this.listWrapper;this.isSimple||(this.$complexWrapper=$.el("table",{"class":"wthtop20 complex uploader",width:"99%","margin-left":"5px"}).append($.el("tr",{}).append($.el("td",{"class":"txtalgnrgt"}).append($.el("label",{"class":"input-label required"}).text("Document Name : ")),$.el("td",{}).append($.el("input",{type:"text",name:this.Identifier+"_docName",id:this.Identifier+"_docName"}).blur({parent:this},function(){return parent.DocumentName=$(this).val()})),$.el("td",{"class":"txtalgnrgt"}).append($.el("label",{"class":"input-label required"}).text("Document Type : ")),$.el("td",{}).append($.el("select",{name:this.Identifier+"_docType",id:this.Identifier+"_docType"}).append($.el("option",{selected:"selected",value:0}).text("Select Type")).change({parent:this},function(n){return n.data.parent.DocumentTypeId=this.value,n.data.parent.DocumentType=$(this).find("option:selected").text()}))),$.el("tr",{}).append($.el("td",{"class":"txtalgnrgt"}).append($.el("label",{"class":"input-label required"}).text("Document : ")),$.el("td",{}).append(this.UploadInput),$.el("td",{"class":""}).append(this.UploadBtn),$.el("td",{}))),console.log(this.$complexWrapper));this.init(this)}return t.p=t.prototype,t.p.Manager,t.p.Wrapper,t.p.UploadWrapper,t.p.UploadInput,t.p.UploadBtn,t.p.Identifier,t.p.AllDocuments=[],t.p.listWrapper,t.p.DocumentName="",t.p.DocumentType="",t.p.DocumentTypeId="",t.p.isSimple,t.p.WaitWrapper,t.p.init=function(n){var i,s,f,r,u,e,h,o,t;if(this.self=n,t=this.self,f=$(this.Wrapper),i=$(this.UploadWrapper),s=$(this.WaitWrapper),$(this.UploadInput).attr("id",this.Identifier+"_input"),$(this.UploadBtn).click({input:this.UploadInput,uplWrapper:this.UploadWrapper,parent:t},function(n){return n.data.parent.wait(!0),new FileUploader("Upload",n.data.parent.documentUploadSuccess,n.data.input,n.data.uplWrapper,n.data.parent)}),$(this.UploadWrapper).attr("id",this.Identifier+"_Uploader"),this.isSimple?i.append(this.UploadInput,this.UploadBtn):i.append(this.$complexWrapper),i.append(s),f.append(this.UploadWrapper),this.Manager.loadAllDocument(f.data("docid")).done(function(n){return console.log(n,"loaded All Documents"),n.Status?(t.AllDocuments=n.ProviderDocumentGET,t.createDocumentsList("doc_"+$(t.Wrapper).data("docid"),t.AllDocuments)):void 0}),this.docTypes=this.Manager.DocumentTypeNames["doc_"+$(this.Wrapper).data("docid")],this.docTypes!=null)for(console.log(this.docTypes),o=this.docTypes,r=e=0,h=o.length;e<h;r=++e)u=o[r],console.log(u,"Value",r,"Key"),this.$complexWrapper.find("#"+this.Identifier+"_docType").first().append($.el("option",{}).val(u.DocumentTypeId).text(u.DocumentTypeIdName))},t.p.documentUploadSuccess=function(){},t.p.createDocumentsList=function(n,t){var u,i,r,f;for(console.log(n,"DocId",t,"Documents"),this.listWrapper=$(this.Wrapper).find(this.Identifier+"_docList").first(),console.log($(this.Wrapper).find(this.Identifier+"_docList").length===0),$(this.Wrapper).find(this.Identifier+"_docList").length===0&&(this.listWrapper=this.createDocumentTableTemplate(),$(this.Wrapper).append(this.listWrapper)),i=r=0,f=t.length;r<f;i=++r)u=t[i],this.addDocumentToList(u,i)},t.p.createDocumentTableTemplate=function(){return $.el("table",{"class":"index vlign grid gridtable",width:"100%"}).append($.el("tr",{}).append($.el("th",{"class":"txtalgnrgt"}).text("Document Type"),$.el("th",{style:"text-align : center"}).text("Document Name"),$.el("th",{}).text("Document Link"),$.el("th",{}).text("Action")))},t.p.addDocumentToList=function(n,t){var i,r,u;console.log(n,Document);u=this;i=$.el("img",{src:"../../Content/Theme1/images/delete.png"}).css("cursor","pointer");r=$.el("tr",{}).append($.el("td",{}).text(n.DocumentTypeIdName),$.el("td",{}).text(n.DocumentName),$.el("td",{}).append($.el("a",{href:n.DocumentPath,"class":"documentdetail"}).text("Document Detail")),$.el("td",{}).append(i));i.click({document:n,ind:t,_self:u,docEle:r},function(n){if(confirm("Really want delete this document?"))return n.data._self.removeDocument(n.data.document,n.data.ind,n.data.docEle,n.data._self)});$(this.listWrapper).append(r)},t.p.removeDocument=function(n,t,i,r){return $(i).remove(),r.Manager.removeDocument(n).done(function(){return $(n).remove(),$(i).remove(),this.refreshDocumentList()})},t.p.refreshDocumentList=function(){if(this.AllDocuments.length===0)return $(this.listWrapper).css("display","none")},t.p.wait=function(n){return n?$(this.WaitWrapper).css("display","block"):$(this.WaitWrapper).css("display","none")},t}()}).call(this);